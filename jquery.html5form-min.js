/*
 *  Html5 Form Plugin - jQuery plugin
 *  Non-standard hack of version 1.1  / English
 *  Copyright (c) 2010 Matias Mancini (http://.matiasmancini.com.ar)
 *  Modified 2011 by Harry Burt <jarry1250@gmail.com>
 *  Dual licensed under the MIT and GPL licenses.
 *  In addition to HTML5, validate(id,test function,error message) can trigger a custom error.
 */ 
(function($){window.validate=function(id,func,message){window.hooks[id]=func;window.errors[id]=message;window.custom.push(document.getElementById(id));};$.fn.html5form=function(options){$(this).each(function(){var defaults={method : $(this).attr('method'),appendTo : null,action : $(this).attr('action'),emptyMessage : 'You left one of more required fields blank.',emailMessage : 'You did not provide a valid email address',errorHeading : 'Error!',hooks : new Array(),errors : new Array()}; var opts=$.extend({},defaults,options);$(opts.appendTo).after("<a name='errorjump'></a><div class='error' id='formerror' style='display:none'><h3>" + opts.errorHeading + "</h3><p id='errortext'></p></div>");var form=$(this);var required=new Array();var email=new Array();window.custom=new Array();window.hooks=opts.hooks;window.errors=opts.errors;function fillInput(input){if(input.attr('placeholder')){input.val(input.attr('placeholder'));if($.browser.mozilla){input.css('-moz-box-shadow','none');}}else{if(!input.data('value')){if(input.val()!=''){input.data('value',input.val());}}else{input.val(input.data('value'));}}}$.each($(':input:visible:not(:button,:submit,:radio,:checkbox,select)',form),function(i) {fillInput($(this));if(this.getAttribute('required')!=null){required[i]=$(this);}if(this.getAttribute('id') in opts.hooks){window.custom[i]=$(this);}$('input').filter(this).each(function(){if(this.getAttribute('type')=='email'){email[i]=$(this);}}); $(this).bind('focus',function(ev){ev.preventDefault();if(this.value==$(this).attr('placeholder')){if(this.getAttribute('type')!='url'){$(this).attr('value','');}}});$(this).bind('blur',function(ev){ev.preventDefault();if(this.value==''){fillInput($(this));}else{if((this.getAttribute('type')=='url') && ($(this).val()==$(this).attr('placeholder'))){fillInput($(this));}}});$('textarea').filter(this).each(function(){if($(this).attr('maxlength')>0){$(this).keypress(function(ev){var cc=ev.charCode||ev.keyCode;if(cc==37||cc==39) {return true;}if(cc==8||cc==46) {return true;}if(this.value.length >=$(this).attr('maxlength')){return false;}else{return true;}});}});});$.each($(':submit',this),function() {$(this).bind('click',function(ev){var emptyInput=null;var emailError=null;var customError=null;var customErrorMessage='';var input=$(':input:visible:not(:button,:submit,:radio,:checkbox,select)',form);$(required).each(function(key,value) {if(value==undefined){return true;}if(($(this).val()==$(this).attr('placeholder'))||($(this).val()=='')){emptyInput=$(this);return false;}return emptyInput;});$(email).each(function(key,value) {if(value==undefined){return true;}if($(this).val().search(/[\w-\.]{3,}@([\w-]{2,}\.)*([\w-]{2,}\.)[\w-]{2,4}/i)){emailError=$(this);return false;}return emailError;});$(window.custom).each(function(key,value) {if(value==undefined){return true;}var theId=$(this).attr('id');var result=window[ window.hooks[theId] ]($(this).val());if(!result){customError=$(this);customErrorMessage=window.errors[theId];return false;}return customError;});if(!emptyInput && !emailError && !customError){$(input).each(function(){if($(this).val()==$(this).attr('placeholder')){$(this).val('');}});$(form).submit(); return true; }else{$('.error').hide();if(emptyInput){$('#errortext').html(opts.emptyMessage);$('#formerror').show();window.document.location.href='#formerror';}else if(emailError){$('#errortext').html(opts.emailMessage);$('#formerror').show();window.document.location.href='#formerror';}else if(customError){$('#errortext').html(customErrorMessage);$('#formerror').show();window.document.location.href='#formerror';}else {alert('Unknown Error');}}return false;});});});}})(jQuery);